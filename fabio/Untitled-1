document.addEventListener('DOMContentLoaded', () => {
    // --- Funcionalidades do Desafio do Dia ---
    const dailyChallengeElement = document.getElementById('daily-challenge');
    const getChallengeBtn = document.getElementById('get-challenge-btn');

    if (dailyChallengeElement && getChallengeBtn) {
        const challenges = [
            "Desligue as luzes ao sair de um cômodo.",
            "Tome um banho mais curto hoje.",
            "Desconecte aparelhos da tomada quando não estiverem em uso.",
            "Separe seu lixo reciclável e orgânico.",
            "Leve sua ecobag para as compras.",
            "Planeje suas refeições para evitar desperdício de alimentos.",
            "Use menos água ao escovar os dentes ou lavar a louça.",
            "Considere ir de bicicleta ou a pé para algum compromisso.",
            "Reutilize uma garrafa de água ou copo hoje.",
            "Pesquise sobre um ponto de coleta de eletrônicos na sua cidade."
        ];

        function getRandomChallenge() {
            const randomIndex = Math.floor(Math.random() * challenges.length);
            return challenges[randomIndex];
        }

        getChallengeBtn.addEventListener('click', () => {
            dailyChallengeElement.textContent = getRandomChallenge();
        });

        dailyChallengeElement.textContent = "Clique no botão para receber seu desafio diário!";
    }


    // --- Funcionalidades de Acessibilidade ---
    const accessibilityBtn = document.getElementById('accessibility-btn');
    const accessibilityPanel = document.getElementById('accessibility-panel');
    const closeAccessibilityBtn = document.getElementById('close-accessibility-btn');

    const increaseFontBtn = document.getElementById('increase-font');
    const decreaseFontBtn = document.getElementById('decrease-font');
    const resetFontBtn = document.getElementById('reset-font');

    const highContrastBtn = document.getElementById('high-contrast');
    const normalContrastBtn = document.getElementById('normal-contrast');

    let currentFontSize = 100; // Porcentagem base do tamanho da fonte

    // Função para aplicar o tamanho da fonte
    function applyFontSize() {
        if (document.body) {
            document.body.style.fontSize = `${currentFontSize}%`;
        }
    }

    // Função para aplicar o contraste
    function applyContrast(isHighContrast) {
        if (document.body) {
            if (isHighContrast) {
                document.body.classList.add('high-contrast');
            } else {
                document.body.classList.remove('high-contrast');
            }
        }
    }

    // ABRIR/FECHAR painel de acessibilidade
    if (accessibilityBtn && accessibilityPanel) {
        accessibilityBtn.addEventListener('click', () => {
            accessibilityPanel.classList.toggle('open');
        });

        // Fechar com o botão X
        if (closeAccessibilityBtn) {
            closeAccessibilityBtn.addEventListener('click', () => {
                accessibilityPanel.classList.remove('open');
            });
        }
        // Fechar clicando fora do painel
        document.addEventListener('click', (event) => {
            // Verifica se o clique não foi no botão de acessibilidade e nem dentro do painel
            if (!accessibilityPanel.contains(event.target) && !accessibilityBtn.contains(event.target) && accessibilityPanel.classList.contains('open')) {
                accessibilityPanel.classList.remove('open');
            }
        });
    }


    // Ajuste de TAMANHO DA FONTE
    if (increaseFontBtn) {
        increaseFontBtn.addEventListener('click', () => {
            if (currentFontSize < 150) { // Limite máximo para não quebrar muito o layout
                currentFontSize += 10;
                applyFontSize();
            }
        });
    }

    if (decreaseFontBtn) {
        decreaseFontBtn.addEventListener('click', () => {
            if (currentFontSize > 80) { // Limite mínimo
                currentFontSize -= 10;
                applyFontSize();
            }
        });
    }

    if (resetFontBtn) {
        resetFontBtn.addEventListener('click', () => {
            currentFontSize = 100;
            applyFontSize();
        });
    }

    // Ajuste de CONTRASTE
    if (highContrastBtn) {
        highContrastBtn.addEventListener('click', () => {
            applyContrast(true);
        });
    }

    if (normalContrastBtn) {
        normalContrastBtn.addEventListener('click', () => {
            applyContrast(false);
        });
    }

    // Aplica o tamanho da fonte padrão ao carregar (importante para que body.style.fontSize esteja definido)
    applyFontSize();
});